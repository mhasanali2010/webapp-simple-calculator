<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebApp Calculator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Simple WebApp Calculator</h1>
    <div class="calculator-container">
        <div class="left-panel">
            <input id="inputbox" disabled>
            <div class="row">
                <button id="(">(</button>
                <button id=")">)</button>
                <button id="C">C</button>
            </div>
            <div class="row">
                <button id="7">7</button>
                <button id="8">8</button>
                <button id="9">9</button>
            </div>
            <div class="row">
                <button id="4">4</button>
                <button id="5">5</button>
                <button id="6">6</button>
            </div>
            <div class="row">
                <button id="1">1</button>
                <button id="2">2</button>
                <button id="3">3</button>
            </div>
            <div class="row">
                <button id="0">0</button>
                <button id=".">.</button>
                <button id="=">=</button>
            </div>
        </div>
        <div class="right-panel">
            <button id="bs">←</button>
            <button id="^">^</button>
            <button id="+">+</button>
            <button id="-">-</button>
            <button id="*">*</button>
            <button id="/">/</button>
        </div>
    </div>
    <script>
        const buttons = ["(",")","C","^","7","8","9","4","5","6","1","2","3","0","+","-","*",".","=","/","←"]
        const allButtons = document.querySelectorAll("button")
        const inputbox = document.getElementById('inputbox')
        
        function sub() {
            fetch('http://localhost:5000/eval', {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({"expression": inputbox.value})
            })
            .then(res => res.json())
            .then(data => inputbox.value = data.result)
        }

        document.addEventListener('keydown', function(event) {
            if (event.key === 'C' || event.key === 'c') {
                inputbox.value = "";
            }
            else if (event.key === '=' || event.key === 'Enter')  {
                sub();
            }
            else if (event.key === 'Backspace') {
                inputbox.value = inputbox.value.slice(0, -1);
                event.preventDefault();
            }
            else if (buttons.includes(event.key)) {
                inputbox.value += event.key;
            }
        })

        allButtons.forEach(button => {
            button.addEventListener("click", () => {
                const key = button.id;

                if (key === 'C') {
                    inputbox.value = "";
                }
                else if (key === '=') {
                    sub();
                }
                else if (key == 'bs') {
                    inputbox.value = inputbox.value.slice(0, -1);
                }
                else {
                    inputbox.value += key;
                }
            })
        })
    </script>
</body>
</html>